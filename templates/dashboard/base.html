<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}管理后台{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#64748b',
                        success: '#10b981',
                        warning: '#f59e0b',
                        danger: '#ef4444',
                        dark: '#1e293b',
                        light: '#f8fafc'
                    }
                }
            }
        }
    </script>
    <style>
        .sidebar {
            transition: all 0.3s ease;
        }

        .card-hover {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.active {
                transform: translateX(0);
            }
        }

        {% block extra_css %}{% endblock %}
    </style>
    {% block extra_head %}{% endblock %}
</head>
<body class="bg-gray-50">
<!-- 移动端菜单按钮 -->
<div class="md:hidden fixed top-4 left-4 z-50">
    <button id="menuToggle" class="p-2 rounded-md bg-white shadow-md text-gray-600">
        <i class="fas fa-bars"></i>
    </button>
</div>

<!-- 侧边栏 -->
<div class="sidebar fixed inset-y-0 left-0 z-40 w-64 bg-white shadow-lg">
    <!-- Logo区域 -->
    <div class="flex items-center justify-center h-16 bg-primary text-white">
        <i class="fas fa-cube text-2xl mr-2"></i>
        <span class="text-xl font-bold">管理后台</span>
    </div>

    <!-- 导航菜单 -->
    <nav class="mt-6 px-4">
        <div class="space-y-2">
            <a href="{{ url_for('dashboard.admin_index') }}"
               class="flex items-center px-4 py-3 rounded-lg {% if request.endpoint == 'dashboard.admin_index' %}text-primary bg-blue-50 font-medium{% else %}text-gray-600 hover:bg-gray-100{% endif %}">
                <i class="fas fa-chart-pie mr-3"></i>
                <span>仪表板</span>
            </a>
            <a href="/admin/blog"
               class="flex items-center px-4 py-3 text-gray-600 hover:bg-gray-100 rounded-lg">
                <i class="fas fa-file-alt mr-3"></i>
                <span>文章管理</span>
            </a>
            <a href="{{ url_for('dashboard.admin_comments') }}"
               class="flex items-center px-4 py-3 rounded-lg {% if request.endpoint == 'dashboard.admin_comments' %}text-primary bg-blue-50 font-medium{% else %}text-gray-600 hover:bg-gray-100{% endif %}">
                <i class="fas fa-comments mr-3"></i>
                <span>评论管理</span>
            </a>
            <a href="/admin/category"
               class="flex items-center px-4 py-3 rounded-lg {% if request.endpoint == 'dashboard.list_categories' %}text-primary bg-blue-50 font-medium{% else %}text-gray-600 hover:bg-gray-100{% endif %}">
                <i class="fas fa-folder mr-3"></i>
                <span>分类管理</span>
            </a>
            <a href="/admin"
               class="flex items-center px-4 py-3 text-gray-600 hover:bg-gray-100 rounded-lg">
                <i class="fas fa-users mr-3"></i>
                <span>用户管理</span>
            </a>
            <a href="{{ url_for('dashboard.admin_settings') }}"
               class="flex items-center px-4 py-3 rounded-lg {% if request.endpoint == 'dashboard.admin_settings' %}text-primary bg-blue-50 font-medium{% else %}text-gray-600 hover:bg-gray-100{% endif %}">
                <i class="fas fa-cog mr-3"></i>
                <span>系统设置</span>
            </a>
        </div>
    </nav>
</div>

<!-- 主内容区域 -->
<div class="md:ml-64 min-h-screen">
    <!-- 顶部导航 -->
    <header class="bg-white shadow-sm">
        <div class="flex justify-between items-center h-16 px-6">
            <div class="flex items-center">
                <h1 class="text-xl font-semibold text-gray-800">{% block page_title %}仪表板{% endblock %}</h1>
            </div>
            <div class="flex items-center space-x-4">
                <!-- 通知 -->
                <div class="relative">
                    <button class="p-2 text-gray-500 hover:text-gray-700">
                        <i class="fas fa-bell"></i>
                    </button>
                    <span class="absolute top-0 right-0 h-2 w-2 rounded-full bg-red-500"></span>
                </div>

                <!-- 用户菜单 -->
                <div class="relative">
                    <button class="flex items-center text-sm text-gray-700 hover:text-gray-900">
                        <div class="h-8 w-8 rounded-full bg-primary flex items-center justify-center text-white">
                            <i class="fas fa-user"></i>
                        </div>
                        <span class="ml-2">{{ current_user.username }}</span>
                        <i class="fas fa-chevron-down ml-1 text-xs"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- 主要内容 -->
    <main class="p-6">
        {% block content %}{% endblock %}
    </main>
</div>

<!-- 通用模态框 -->
<div id="genericModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-20 mx-auto p-5 border w-full max-w-md shadow-lg rounded-md bg-white">
        <div class="mt-3">
            <div class="flex justify-between items-center pb-3 border-b">
                <h3 class="text-lg font-medium text-gray-900" id="modalTitle">标题</h3>
                <button class="close-modal text-gray-400 hover:text-gray-500">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="modalContent" class="mt-4">
                <!-- 模态框内容 -->
            </div>
        </div>
    </div>
</div>

<!-- 删除确认模态框 -->
<div id="deleteModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
        <div class="mt-3 text-center">
            <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100">
                <i class="fas fa-exclamation-triangle text-red-600"></i>
            </div>
            <h3 class="text-lg leading-6 font-medium text-gray-900 mt-2">确认删除</h3>
            <div class="mt-2 px-7 py-3">
                <p class="text-sm text-gray-500" id="deleteMessage">
                    您确定要删除这个项目吗？此操作不可撤销。
                </p>
            </div>
            <div class="items-center px-4 py-3 mt-3">
                <button id="confirmDelete"
                        class="px-4 py-2 bg-red-600 text-white text-base font-medium rounded-md w-full shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-300">
                    确认删除
                </button>
                <button class="cancel-delete mt-2 px-4 py-2 bg-gray-300 text-gray-700 text-base font-medium rounded-md w-full shadow-sm hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-300">
                    取消
                </button>
            </div>
        </div>
    </div>
</div>

<script>
    // 移动端菜单切换
    document.getElementById('menuToggle').addEventListener('click', function () {
        document.querySelector('.sidebar').classList.toggle('active');
    });

    // 点击侧边栏外部关闭菜单
    document.addEventListener('click', function (event) {
        const sidebar = document.querySelector('.sidebar');
        const menuToggle = document.getElementById('menuToggle');

        if (window.innerWidth <= 768 &&
            !sidebar.contains(event.target) &&
            !menuToggle.contains(event.target)) {
            sidebar.classList.remove('active');
        }
    });

    // 通用模态框控制
    document.querySelectorAll('.close-modal, .cancel-delete').forEach(button => {
        button.addEventListener('click', function () {
            document.getElementById('genericModal').classList.add('hidden');
            document.getElementById('deleteModal').classList.add('hidden');
        });
    });

    // 删除确认功能
    let deleteCallback = null;

    function showDeleteConfirm(message, callback) {
        document.getElementById('deleteMessage').textContent = message;
        deleteCallback = callback;
        document.getElementById('deleteModal').classList.remove('hidden');
    }

    document.getElementById('confirmDelete').addEventListener('click', function () {
        if (deleteCallback) {
            deleteCallback();
        }
        document.getElementById('deleteModal').classList.add('hidden');
    });

    // 通用模态框显示函数
    function showModal(title, content) {
        document.getElementById('modalTitle').textContent = title;
        document.getElementById('modalContent').innerHTML = content;
        document.getElementById('genericModal').classList.remove('hidden');
    }

    {% block extra_scripts %}{% endblock %}
</script>
</body>
</html>