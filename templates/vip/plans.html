{% extends "vip/base.html" %}

{% block title %}VIP套餐选择{% endblock %}

{% block content %}
    <div class="text-center mb-8">
        <h1 class="text-3xl font-bold text-gray-900 mb-2">选择适合您的VIP套餐</h1>
        <p class="text-gray-600">多种套餐选择，满足不同需求</p>
    </div>

    <div class="grid lg:grid-cols-3 gap-8 mb-8">
        {% for plan in plans %}
            <div class="bg-white rounded-xl shadow-lg border {% if plan.level == 2 %}border-purple-500 ring-4 ring-purple-100 transform scale-105{% endif %}">
                {% if plan.level == 2 %}
                    <div class="bg-purple-500 text-white text-center py-2 rounded-t-xl">
                        <i class="fas fa-crown mr-2"></i>最受欢迎
                    </div>
                {% endif %}

                <div class="p-8">
                    <div class="text-center mb-6">
                        <h3 class="text-2xl font-bold text-gray-900">{{ plan.name }}</h3>
                        <div class="my-4">
                            <span class="text-4xl font-bold text-purple-600">¥{{ plan.price }}</span>
                            {% if plan.original_price and plan.original_price > plan.price %}
                                <span class="text-gray-400 line-through ml-2">¥{{ plan.original_price }}</span>
                                {% set discount = ((plan.original_price - plan.price) / plan.original_price * 100) | round(0) %}
                                <span class="bg-red-100 text-red-800 text-xs font-semibold ml-2 px-2.5 py-0.5 rounded">
                                    {{ discount }}% OFF
                                </span>
                            {% endif %}
                            <span class="text-gray-600 block mt-1">/ {{ plan.duration_days }}天</span>
                        </div>
                        
                        <!-- 日均费用 -->
                        {% if plan.daily_cost %}
                            <p class="text-green-600 font-semibold">平均每天仅 ¥{{ "%.2f"|format(plan.daily_cost) }}</p>
                        {% endif %}
                    </div>

                    <ul class="space-y-3 mb-8">
                        {% for feature in features %}
                            <li class="flex items-center {% if feature.required_level <= plan.level %}text-gray-800{% else %}text-gray-400{% endif %}">
                                <i class="fas {% if feature.required_level <= plan.level %}fa-check text-green-500{% else %}fa-times text-gray-300{% endif %} mr-3"></i>
                                <span title="{{ feature.description }}">{{ feature.name }}</span>
                                {% if feature.required_level > plan.level %}
                                    <span class="ml-2 text-xs bg-gray-100 px-2 py-1 rounded">VIP {{ feature.required_level }}</span>
                                {% endif %}
                            </li>
                        {% endfor %}
                    </ul>
                    <div class="flex justify-center">
                        {% if current_user.vip_level < plan.level %}
                            <a href="{{ url_for('vip.payment_page', plan_id=plan.id) }}"
                               class="bg-purple-600 text-white px-4 py-2 rounded-lg">
                                立即升级
                            </a>
                        {% elif current_user.vip_level == plan.level %}
                            <a href="#"
                               class="bg-gray-300 text-gray-800 px-4 py-2 rounded-lg">
                                已订阅相同等级
                            </a>
                        {% endif %}
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

    <!-- 常见问题 -->
    <div class="bg-white rounded-lg shadow-sm p-6">
        <h2 class="text-2xl font-bold mb-6">常见问题</h2>
        <div class="grid md:grid-cols-2 gap-6">
            <div>
                <h3 class="font-semibold mb-2">Q: VIP会员可以随时取消吗？</h3>
                <p class="text-gray-600">A: 是的，VIP会员服务按周期计费，您可以随时取消自动续费。</p>
            </div>
            <div>
                <h3 class="font-semibold mb-2">Q: 购买后可以退款吗？</h3>
                <p class="text-gray-600">A: 虚拟商品一经购买概不退款，请在购买前确认需求。</p>
            </div>
            <div>
                <h3 class="font-semibold mb-2">Q: 可以同时拥有多个套餐吗？</h3>
                <p class="text-gray-600">A: 不可以，每个用户只能激活一个VIP套餐。</p>
            </div>
            <div>
                <h3 class="font-semibold mb-2">Q: VIP特权包含哪些内容？</h3>
                <p class="text-gray-600">A: 包含专属内容、去广告、个性化功能等，具体请查看<a
                        href="{{ url_for('vip.features') }}" class="text-purple-600 hover:underline">特权详情</a>。</p>
            </div>
        </div>
    </div>
{% endblock %}