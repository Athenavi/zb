<!-- templates/comment_item.html -->
<div class="comment-item bg-white rounded-lg p-4 border border-gray-100 fade-in" data-id="{{ comment.comment.id }}">
    <div class="flex items-start">
        <div class="flex-shrink-0">
            <img src="/static/avatar/{{ comment.comment.author.profile_picture }}.webp"
                 alt="{{ comment.comment.author.username }}"
                 class="w-8 h-8 sm:w-10 sm:h-10 rounded-full object-cover mr-3 border-2 border-white shadow-sm">
        </div>
        <div class="flex-1 min-w-0">
            <div class="comment-header flex flex-wrap items-center mb-2">
                <span class="font-semibold text-gray-800 mr-2 truncate">
                    {{ comment.comment.author.username }}
                </span>
                <span class="text-xs text-gray-500 whitespace-nowrap">
                    {{ comment.comment.created_at|relative_time }}
                </span>
            </div>

            <div class="comment-body text-gray-700 mb-3 text-sm sm:text-base">
                {{ comment.comment.content }}
            </div>

            <div class="comment-actions">
                <button class="reply-btn text-xs sm:text-sm text-blue-600 hover:text-blue-800 transition-colors flex items-center"
                        data-id="{{ comment.comment.id }}"
                        data-username="{{ comment.comment.author.username }}">
                    <i class="fas fa-reply mr-1"></i> 回复
                </button>
            </div>
        </div>
    </div>

    <!-- 回复列表 -->
    {% if comment.replies %}
        <div class="replies mt-4 pl-0 sm:pl-6 border-l-0 sm:border-l-2 border-gray-100">
            {% for reply in comment.replies %}
                {% with comment=reply, depth=depth+1 %}
                    {% include 'comment_item.html' %}
                {% endwith %}
            {% endfor %}
        </div>
    {% endif %}
</div>